<!DOCTYPE html>

<html lang="en-us">

<head>

  <meta charset="UTF-8">
  <title>Employee Tracker</title>

  <!-- jQuery -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  <!-- Bootstrap CDN-->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

  <!-- Firebase Reference -->
  <script src="https://www.gstatic.com/firebasejs/5.7.3/firebase.js"></script>

 <!-- Link To Moment -->
  <script src="cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>

</head>

<body>

  <div class="container">

    <br>

    <!-- Jumbotron Title -->
    <div class="jumbotron">
      <h1 class="text-center">Employee Tracker</h1>
    </div>
    <!-- Current Employees Table -->
    <div class="row">
      <div class="col-lg-12">
        <div class="card card-default">
          <div class="card-header">
              Current Employees
          </div>
          <div class="card-body">
              <table class="table table-hover">
                  <thead>
                    <tr>
                      <th scope="col">Employee Name</th>
                      <th scope="col">Role</th>
                      <th scope="col">Start Date</th>
                      <th scope="col">Months Worked</th>
                      <th scope="col">Monthly Rate ($)</th>
                      <th scope="col">Total Bill ($)</th>
                    </tr>
                  </thead>
                  <tbody id="employeeInfo">
                    
                  </tbody>
                </table>

            </div>
        </div>
      </div>
    </div>
  </div>

  
<br> 
  <!-- Enter Employees Info -->
  <div class="container">
    <div class="row">
    <div class="col-lg-12">
      <div class="card card-default">
        <div class="card-header">
          Add Employee
        </div>
        <div class="card-body">
          <form>
            <div class="form-group row">
              <label for="name">Employee Name</label>
              <input class="form-control" id="name" type="text">
            </div>
            <div class="form-group row">
              <label for="role">Role</label>
              <input class="form-control" id="role" type="text">
            </div>
            <div class="form-group row">
              <label for="startDate">Start Date (MM/DD/YYYY)</label>
              <input class="form-control" id="startDate" type="date">
            </div>
            <div class="form-group row">
              <label for="monthlyRate">Monthly Rate</label>
              <input class="form-control" id="monthlyRate" type="number">
            </div>
            <button class="btn btn-primary" id="submit-info" type="submit-info">Submit</button>
          </form>
        </div>
      </div>
    </div>
  </div>
 

  

  <!-- Script -->
  <script>
    // Initialize Firebase
  var config = {
    apiKey: "AIzaSyCxTRjzvbTcdJmKxMVKQu7x3t_1VxJ1qFo",
    authDomain: "my-project-1804a.firebaseapp.com",
    databaseURL: "https://my-project-1804a.firebaseio.com",
    projectId: "my-project-1804a",
    storageBucket: "my-project-1804a.appspot.com",
    messagingSenderId: "511888501188"
  };
  firebase.initializeApp(config);

//Create variable to refference the database 
var database =firebase.database();


    $("#submit-info").on("click", function() {
      //Prevents page refresh
      event.preventDefault(); 
      //Create obj 

  var employee = { 
    name: $("#name").val().trim(),
    role: $("#role").val().trim(),
    start: $("#startDate").val().trim(),
    rate: $("#monthlyRate").val().trim(),
  }
  database.ref().push(employee); 
});

// The callback function you specify will be called for each child in the DB
database.ref().on("child_added", submit);

  
  //appen a table row to display employee data
  console.log("child",employee); 
var startDateDisplay = moment 
.unix(employee.start)
.format("MM/DD/YYYY");

var totalMonths = moment().diff(
  moment(employee,start, "X"),
  "months"
);

var totalBilled = totalMonths * employee.rate; 
  //TODO: Append a table row to display emoyee data
  
    //1. Make a new <tr> element
       // 2. Fill in the html for it 
  

    function submit(snapshot) {
      var employeeData = snapshot.val();
          //3. Append that tr element to the tbody 
      var newRow = $("<tr>").append(
        $("<td>").text(employeeData.name),
        $("<td>").text(employeeData.role),
        $("<td>").text(startDateDisplay),
       // $("<td>").text(totalMonths),
     //   $("<td>").text(employee.rate),
      //  $("<td>").text(totalBilled),

      );
      $("#employeeInfo").append(newRow);
    }
  

  
  </script>

</body>

</html>
